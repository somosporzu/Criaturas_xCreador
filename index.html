<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creador de Criaturas - Sistema PAPA</title>
    <meta name="description" content="Herramienta web para crear criaturas equilibradas usando el sistema modular de Nivel de DesafÃ­o (ND)">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        const CreatureCreator = () => {
          const [name, setName] = useState('');
          const [nd, setND] = useState('1');
          const [size, setSize] = useState('mediano');
          const [category, setCategory] = useState('bestias');
          const [tag, setTag] = useState('');
          const [concept, setConcept] = useState('');
          const [nature, setNature] = useState('');
          const [description, setDescription] = useState('');
          const [selectedTraits, setSelectedTraits] = useState([]);
          const [notification, setNotification] = useState(null);
          const [openCategory, setOpenCategory] = useState(null);
          const [cuerpoMod, setCuerpoMod] = useState(0);
          const [destrezaMod, setDestrezaMod] = useState(0);
          const [auraMod, setAuraMod] = useState(0);
          const [equipment, setEquipment] = useState([]);
          const [openEquipmentCategory, setOpenEquipmentCategory] = useState(null);

          const ndStats = {
            '1/8': { resistencia: 4, defensa: 7, atributos: 0, danoBase: '1d6-3', pr: 0 },
            '1/4': { resistencia: 7, defensa: 8, atributos: 0, danoBase: '1d6-2', pr: 1 },
            '1/2': { resistencia: 12, defensa: 8, atributos: 1, danoBase: '1d6-1', pr: 1 },
            '1': { resistencia: 17, defensa: 8, atributos: 2, danoBase: '1d6', pr: 2 },
            '2': { resistencia: 27, defensa: 8, atributos: 3, danoBase: '1d6+1', pr: 3 },
            '3': { resistencia: 37, defensa: 9, atributos: 4, danoBase: '2d6-1', pr: 4 },
            '4': { resistencia: 52, defensa: 9, atributos: 4, danoBase: '2d6', pr: 5 },
            '5': { resistencia: 67, defensa: 10, atributos: 5, danoBase: '2d6+1', pr: 6 },
            '6': { resistencia: 72, defensa: 10, atributos: 5, danoBase: '2d6+2', pr: 7 },
            '7': { resistencia: 82, defensa: 11, atributos: 6, danoBase: '2d6+2', pr: 8 },
            '8': { resistencia: 92, defensa: 11, atributos: 6, danoBase: '2d6+3', pr: 9 },
            '9': { resistencia: 102, defensa: 12, atributos: 7, danoBase: '3d6', pr: 10 },
            '10': { resistencia: 112, defensa: 12, atributos: 7, danoBase: '3d6+1', pr: 10 },
            '11': { resistencia: 122, defensa: 12, atributos: 7, danoBase: '3d6+1', pr: 11 },
            '12': { resistencia: 132, defensa: 13, atributos: 8, danoBase: '3d6+2', pr: 11 },
            '13': { resistencia: 142, defensa: 13, atributos: 8, danoBase: '4d6', pr: 12 },
            '14': { resistencia: 152, defensa: 14, atributos: 9, danoBase: '4d6+1', pr: 13 },
            '15': { resistencia: 162, defensa: 14, atributos: 9, danoBase: '4d6+2', pr: 14 }
          };

          const sizeModifiers = {
            minusculo: { resistencia: -5, defensa: 3, label: 'MinÃºsculo' },
            pequeno: { resistencia: -5, defensa: 1, label: 'PequeÃ±o' },
            mediano: { resistencia: 0, defensa: 0, label: 'Mediano' },
            grande: { resistencia: 15, defensa: -1, label: 'Grande' },
            enorme: { resistencia: 30, defensa: -2, label: 'Enorme' },
            colosal: { resistencia: 60, defensa: -4, label: 'Colosal' }
          };

          const traits = {
            'Atributos y Vitalidad': [
              { name: 'Deficiencia de Atributo', cost: -1, desc: 'Reduce en -1 un Atributo Primario' },
              { name: 'Mejora de Atributo', cost: 2, desc: 'Aumenta en +1 un Atributo Primario' },
              { name: 'Versatilidad Conceptual', cost: 2, desc: 'Aprende un nuevo Concepto' },
              { name: 'Versatilidad de CarÃ¡cter', cost: 1, desc: 'Aprende una nueva Naturaleza' },
              { name: 'Vitalidad Aumentada', cost: 1, desc: '+10 Resistencia mÃ¡xima' }
            ],
            'Ofensivos': [
              { name: 'Alcance Mejorado', cost: 1, desc: 'Alcance +3m' },
              { name: 'Ataque Adicional', cost: 1, desc: 'Segundo ataque sin bono' },
              { name: 'Ataque Poderoso', cost: 1, desc: '-2 ataque, +3 daÃ±o' },
              { name: 'Carga Imparable', cost: 1, desc: '+1d6 tras 5m rectos' },
              { name: 'CrÃ­tico Mejorado', cost: 2, desc: 'CrÃ­tico con 5-6' },
              { name: 'Drenaje', cost: 3, desc: 'Recupera daÃ±o como resistencia' },
              { name: 'Furia', cost: 2, desc: '+1d6 con â‰¤50% Resistencia' },
              { name: 'Sangrado', cost: 1, desc: 'Objetivo sufre 1d6 en turno' }
            ],
            'Defensivos': [
              { name: 'Armadura Natural', cost: 1, desc: '+1 Defensa' },
              { name: 'CorazÃ³n Doble', cost: 3, desc: 'A 0 queda con mitad' },
              { name: 'Escurridizo', cost: 1, desc: 'Sin ataques de oportunidad' },
              { name: 'Inmune', cost: 2, desc: 'Inmune a tipo de daÃ±o' },
              { name: 'Piel Gruesa', cost: 1, desc: 'Ignora 1 daÃ±o' },
              { name: 'RegeneraciÃ³n Mayor', cost: 2, desc: 'Recupera 5 al inicio' },
              { name: 'Resistente', cost: 1, desc: 'Resistencia a daÃ±o' },
              { name: 'Vulnerable', cost: -2, desc: 'Vulnerable a daÃ±o' }
            ],
            'Movilidad': [
              { name: 'Anfibio', cost: 1, desc: 'Respira aire y agua' },
              { name: 'Iniciativa Mejorada', cost: 1, desc: '+3 iniciativa' },
              { name: 'Movimiento Especial', cost: 1, desc: 'Nadar/Trepar/Excavar' },
              { name: 'Pies Ligeros', cost: 1, desc: 'Ignora terreno difÃ­cil' },
              { name: 'Velocidad Mejorada', cost: 1, desc: '+3m velocidad' },
              { name: 'Vuelo', cost: 2, desc: 'Velocidad de vuelo' }
            ],
            'Aura y PercepciÃ³n': [
              { name: 'Aura de Miedo', cost: 3, desc: 'Asustado a 5m' },
              { name: 'Sentido Ciego', cost: 2, desc: 'Ve sin ojos 10m' },
              { name: 'Sentidos Agudos', cost: 1, desc: 'Ventaja en percepciÃ³n' },
              { name: 'VisiÃ³n en Oscuridad', cost: 1, desc: 'Ve en oscuridad' }
            ],
            'Control y Ãšnicos': [
              { name: 'Jefe Solitario', cost: 3, desc: 'AcciÃ³n RÃ¡pida extra' },
              { name: 'Resistencia Legendaria', cost: 2, desc: 'Supera 1 SalvaciÃ³n' }
            ]
          };

          const weapons = {
            'Simples Cuerpo a Cuerpo': [
              { name: 'Arma Improvisada', damage: '1d6-3', type: 'Variable', properties: '-' },
              { name: 'Daga/Cuchillo', damage: '1d6-2', type: 'Penetrante', properties: 'Ligera, Arrojadiza (5/10)' },
              { name: 'BastÃ³n', damage: '1d6-1', type: 'Contundente', properties: 'A dos manos' },
              { name: 'Maza Ligera', damage: '1d6', type: 'Contundente', properties: 'Ligera' },
              { name: 'Hoz', damage: '1d6-1', type: 'Cortante', properties: 'Ligera' },
              { name: 'Lanza Corta', damage: '1d6', type: 'Penetrante', properties: 'Arrojadiza (10/20)' }
            ],
            'Marciales Cuerpo a Cuerpo': [
              { name: 'Espada Corta', damage: '1d6', type: 'Cortante', properties: 'Ligera' },
              { name: 'Hacha de Mano', damage: '1d6', type: 'Cortante', properties: 'Ligera, Arrojadiza (5/10)' },
              { name: 'Estoque', damage: '1d6', type: 'Penetrante', properties: 'Ligera' },
              { name: 'Lanza', damage: '1d6+1', type: 'Penetrante', properties: 'VersÃ¡til (2d6-1), Alcance' },
              { name: 'Espada Larga', damage: '1d6+1', type: 'Cortante', properties: 'VersÃ¡til (2d6)' },
              { name: 'Martillo de Guerra', damage: '1d6+1', type: 'Contundente', properties: 'VersÃ¡til (2d6)' },
              { name: 'Maza Pesada', damage: '2d6-1', type: 'Contundente', properties: 'Pesada' },
              { name: 'Alabarda', damage: '2d6', type: 'Cortante/Penetrante', properties: 'Pesada, A dos manos, Alcance' },
              { name: 'Mandoble', damage: '2d6', type: 'Cortante', properties: 'Pesada, A dos manos' },
              { name: 'Gran Hacha', damage: '2d6+1', type: 'Cortante', properties: 'Pesada, A dos manos' }
            ],
            'Armas a Distancia': [
              { name: 'Honda', damage: '1d6-2', type: 'Contundente', properties: 'Rango (15/30)' },
              { name: 'Arco Corto', damage: '1d6', type: 'Penetrante', properties: 'A dos manos, Rango (20/40)' },
              { name: 'Ballesta Ligera', damage: '1d6+1', type: 'Penetrante', properties: 'A dos manos, Rango (25/50), Recarga' },
              { name: 'Arco Largo', damage: '1d6+1', type: 'Penetrante', properties: 'Pesada, A dos manos, Rango (35/70)' },
              { name: 'Ballesta Pesada', damage: '2d6', type: 'Penetrante', properties: 'Pesada, A dos manos, Rango (40/80), Recarga' }
            ]
          };

          const armors = [
            { name: 'Sin Armadura', bonus: 0, dexLimit: 99, properties: '-' },
            { name: 'Ropas Acolchadas', bonus: 2, dexLimit: 99, properties: 'Ligera' },
            { name: 'Armadura de Cuero', bonus: 3, dexLimit: 99, properties: 'Ligera' },
            { name: 'GambesÃ³n Reforzado', bonus: 3, dexLimit: 99, properties: 'Ligera, Sigilo -1' },
            { name: 'Cota de Mallas', bonus: 4, dexLimit: 2, properties: 'Media, Sigilo -1' },
            { name: 'Armadura de Escamas', bonus: 5, dexLimit: 2, properties: 'Media, Sigilo -2' },
            { name: 'Armadura de Placas', bonus: 6, dexLimit: 1, properties: 'Pesada, Sigilo -3' },
            { name: 'Armadura Completa', bonus: 7, dexLimit: 0, properties: 'Pesada, Sigilo -4' }
          ];

          const shields = [
            { name: 'Sin Escudo', bonus: 0, properties: '-' },
            { name: 'Broquel', bonus: 1, properties: 'Ligero' },
            { name: 'Rodela PequeÃ±a', bonus: 2, properties: 'Ligero, Sigilo -1' },
            { name: 'Escudo Redondo', bonus: 2, properties: 'Medio, Sigilo -1' },
            { name: 'Escudo EstÃ¡ndar', bonus: 3, properties: 'Medio, Sigilo -2' },
            { name: 'Escudo Grande', bonus: 3, properties: 'Pesado, Sigilo -3' },
            { name: 'Escudo de Torre', bonus: 4, properties: 'Pesado, Sigilo -3' }
          ];

          const naturalezas = [
            'Alegremente', 'Apasionadamente', 'Astutamente', 'Brutalmente', 'CaÃ³ticamente',
            'CarismÃ¡ticamente', 'Cautelosamente', 'Curiosamente', 'Despiadadamente', 'Discretamente',
            'Elegantemente', 'FrÃ­amente', 'Impulsivamente', 'Inestablemente', 'MetÃ³dicamente',
            'RÃ¡pidamente', 'Silenciosamente', 'Siniestramente', 'Sutilmente', 'Tenazmente',
            'Torpemente', 'Valientemente'
          ];

          const addTrait = (trait) => {
            setSelectedTraits([...selectedTraits, { ...trait, id: Date.now() }]);
          };

          const removeTrait = (id) => {
            setSelectedTraits(selectedTraits.filter(t => t.id !== id));
          };

          const addEquipment = (item, type) => {
            setEquipment([...equipment, { ...item, type, id: Date.now() }]);
          };

          const removeEquipment = (id) => {
            setEquipment(equipment.filter(e => e.id !== id));
          };

          const calculateStats = () => {
            const baseStats = ndStats[nd];
            const sizeMods = sizeModifiers[size];
            const traitPR = selectedTraits.reduce((sum, t) => sum + t.cost, 0);
            
            const attrModCost = (cuerpoMod * 2) + (destrezaMod * 2) + (auraMod * 2);
            
            const cuerpoFinal = baseStats.atributos + cuerpoMod;
            const destrezaFinal = baseStats.atributos + destrezaMod;
            const auraFinal = baseStats.atributos + auraMod;
            
            const selectedArmor = equipment.find(e => e.type === 'armor') || armors[0];
            const selectedShield = equipment.find(e => e.type === 'shield') || shields[0];
            
            const armorBonus = selectedArmor?.bonus || 0;
            const shieldBonus = selectedShield?.bonus || 0;
            const dexLimit = selectedArmor?.dexLimit !== undefined ? selectedArmor.dexLimit : 99;
            const effectiveDexBonus = Math.min(destrezaFinal, dexLimit);
            
            const defensa = 5 + effectiveDexBonus + armorBonus + shieldBonus + sizeMods.defensa;
            const iniciativa = destrezaFinal + auraFinal - 2;
            const movimiento = 9 + Math.max(0, destrezaFinal);
            
            return {
              resistencia: baseStats.resistencia + sizeMods.resistencia,
              defensa: defensa,
              cuerpo: cuerpoFinal,
              destreza: destrezaFinal,
              aura: auraFinal,
              iniciativa: iniciativa,
              movimiento: movimiento,
              danoBase: baseStats.danoBase,
              prBase: baseStats.pr,
              prUsed: traitPR + attrModCost,
              prRemaining: baseStats.pr - traitPR - attrModCost
            };
          };

          const exportAsText = () => {
            const stats = calculateStats();
            const selectedArmor = equipment.find(e => e.type === 'armor');
            const selectedShield = equipment.find(e => e.type === 'shield');
            const weapons = equipment.filter(e => e.type === 'weapon');
            
            let text = '#' + name.toUpperCase() + '\n';
            text += category.charAt(0).toUpperCase() + category.slice(1);
            if (tag) text += ' (' + tag + ')';
            text += ' ' + sizeModifiers[size].label + '; ND ' + nd + '\n\n';
            
            text += '## EstadÃ­sticas\n';
            text += 'Resistencia: ' + stats.resistencia + '\n';
            text += 'Defensa: ' + stats.defensa + '\n';
            text += 'Cuerpo: ' + (stats.cuerpo >= 0 ? '+' : '') + stats.cuerpo;
            text += ' | Destreza: ' + (stats.destreza >= 0 ? '+' : '') + stats.destreza;
            text += ' | Aura: ' + (stats.aura >= 0 ? '+' : '') + stats.aura + '\n';
            text += 'Iniciativa: ' + (stats.iniciativa >= 0 ? '+' : '') + stats.iniciativa + '\n';
            text += 'Movimiento: ' + stats.movimiento + ' metros\n';
            text += 'Naturaleza: ' + (nature || 'No asignada') + '\n\n';
            
            if (description) {
              text += '## DescripciÃ³n\n' + description + '\n\n';
            }
            
            if (selectedArmor || selectedShield || weapons.length > 0) {
              text += '## Equipo\n';
              if (selectedArmor) text += '- ' + selectedArmor.name + ' (Bono: +' + selectedArmor.bonus + ', ' + selectedArmor.properties + ')\n';
              if (selectedShield) text += '- ' + selectedShield.name + ' (Bono: +' + selectedShield.bonus + ', ' + selectedShield.properties + ')\n';
              weapons.forEach(w => {
                text += '- ' + w.name + ' (DaÃ±o: ' + w.damage + ' ' + w.type + ', ' + w.properties + ')\n';
              });
              text += '\n';
            }
            
            if (selectedTraits.length > 0) {
              text += '## Rasgos\n';
              if (concept) text += '**' + concept + ' (CategorÃ­a):** ' + 'Concepto de la criatura\n';
              selectedTraits.forEach(trait => {
                const sign = trait.cost > 0 ? '+' : '';
                text += '**' + trait.name + ' (' + sign + trait.cost + ' PR):** ' + trait.desc + '\n';
              });
              text += '\n';
            }
            
            if (weapons.length > 0) {
              text += '## Acciones\n';
              weapons.forEach(w => {
                const weaponAttr = w.properties.includes('Ligera') ? stats.destreza : stats.cuerpo;
                const attackBonus = weaponAttr;
                text += '**' + w.name + ':** Bono de Ataque +' + attackBonus;
                text += ', DaÃ±o ' + w.damage;
                if (weaponAttr !== 0) {
                  text += (weaponAttr > 0 ? '+' : '') + weaponAttr;
                }
                text += ' ' + w.type + '\n';
              });
              text += '\n';
            }
            
            text += '---\n';
            text += 'PR Usados: ' + stats.prUsed + '/' + stats.prBase + ' | Restantes: ' + stats.prRemaining + '\n';
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = (name || 'criatura').replace(/\s+/g, '_') + '.md';
            a.click();
            URL.revokeObjectURL(url);
            
            setNotification('âœ… Archivo descargado');
            setTimeout(() => setNotification(null), 3000);
          };

          const stats = calculateStats();

          return (
            <div className="min-h-screen bg-gradient-to-br from-slate-900 via-red-900 to-slate-900 p-4">
              {notification && (
                <div className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50">
                  {notification}
                </div>
              )}
              
              <div className="max-w-7xl mx-auto">
                <header className="text-center mb-8 pt-6">
                  <h1 className="text-5xl font-bold text-red-400 mb-2">Creador de Criaturas</h1>
                  <p className="text-slate-300 text-lg">Sistema modular por Nivel de DesafÃ­o</p>
                </header>

                <div className="grid lg:grid-cols-3 gap-6">
                  <div className="lg:col-span-2 space-y-6">
                    <div className="bg-slate-800 rounded-lg shadow-xl p-6 border-2 border-red-600">
                      <h2 className="text-2xl font-bold text-red-400 mb-4">InformaciÃ³n BÃ¡sica</h2>
                      
                      <div className="space-y-4">
                        <div>
                          <label className="block text-slate-300 mb-2 font-semibold">Nombre *</label>
                          <input
                            type="text"
                            value={name}
                            onChange={(e) => setName(e.target.value)}
                            placeholder="Ej: DragÃ³n Rojo"
                            className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                          />
                        </div>

                        <div className="grid md:grid-cols-3 gap-4">
                          <div>
                            <label className="block text-slate-300 mb-2 font-semibold">ND *</label>
                            <select
                              value={nd}
                              onChange={(e) => setND(e.target.value)}
                              className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                            >
                              {Object.keys(ndStats).map(level => (
                                <option key={level} value={level}>ND {level}</option>
                              ))}
                            </select>
                          </div>
                          
                          <div>
                            <label className="block text-slate-300 mb-2 font-semibold">TamaÃ±o *</label>
                            <select
                              value={size}
                              onChange={(e) => setSize(e.target.value)}
                              className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                            >
                              {Object.keys(sizeModifiers).map(s => (
                                <option key={s} value={s}>{sizeModifiers[s].label}</option>
                              ))}
                            </select>
                          </div>
                          
                          <div>
                            <label className="block text-slate-300 mb-2 font-semibold">CategorÃ­a *</label>
                            <select
                              value={category}
                              onChange={(e) => setCategory(e.target.value)}
                              className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                            >
                              <option value="bestias">Bestias</option>
                              <option value="monstruos">Monstruos</option>
                              <option value="espiritus">EspÃ­ritus</option>
                              <option value="exaltados">Exaltados</option>
                              <option value="corruptos">Corruptos</option>
                              <option value="elementales">Elementales</option>
                              <option value="artificiales">Artificiales</option>
                              <option value="npc">NPC</option>
                            </select>
                          </div>
                        </div>

                        <div>
                          <label className="block text-slate-300 mb-2 font-semibold">Etiqueta</label>
                          <input
                            type="text"
                            value={tag}
                            onChange={(e) => setTag(e.target.value)}
                            placeholder="Ej: Insecto, DragÃ³n"
                            className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                          />
                        </div>

                        <div className="grid md:grid-cols-2 gap-4">
                          <div>
                            <label className="block text-slate-300 mb-2 font-semibold">Concepto</label>
                            <input
                              type="text"
                              value={concept}
                              onChange={(e) => setConcept(e.target.value)}
                              placeholder="Por defecto: categorÃ­a"
                              className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                            />
                          </div>
                          
                          <div>
                            <label className="block text-slate-300 mb-2 font-semibold">Naturaleza</label>
                            <select
                              value={nature}
                              onChange={(e) => setNature(e.target.value)}
                              className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none"
                            >
                              <option value="">Seleccionar...</option>
                              {naturalezas.map(nat => (
                                <option key={nat} value={nat}>{nat}</option>
                              ))}
                            </select>
                          </div>
                        </div>
                        
                        <div>
                          <label className="block text-slate-300 mb-2 font-semibold">DescripciÃ³n</label>
                          <textarea
                            value={description}
                            onChange={(e) => setDescription(e.target.value)}
                            placeholder="Describe la criatura..."
                            rows="2"
                            className="w-full px-4 py-2 bg-slate-700 text-white rounded border-2 border-slate-600 focus:border-red-500 outline-none resize-none"
                          />
                        </div>
                      </div>
                    </div>

                    <div className="bg-slate-800 rounded-lg shadow-xl p-6 border-2 border-green-600">
                      <h2 className="text-2xl font-bold text-green-400 mb-4">Ajuste de Atributos</h2>
                      <p className="text-slate-300 text-sm mb-4">
                        Aumentar: +2 PR por punto | Disminuir: -1 PR por punto (mÃ­n. -3)
                      </p>
                      
                      <div className="space-y-4">
                        <div>
                          <label className="block text-slate-300 mb-2 font-semibold">
                            Cuerpo (Base: +{ndStats[nd].atributos})
                          </label>
                          <div className="flex items-center gap-2">
                            <button
                              onClick={() => setCuerpoMod(Math.max(cuerpoMod - 1, -ndStats[nd].atributos - 3))}
                              className="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold"
                            >
                              âˆ’
                            </button>
                            <div className="flex-1 text-center bg-slate-700 py-2 rounded text-white font-bold">
                              {cuerpoMod >= 0 ? '+' : ''}{cuerpoMod} ({cuerpoMod * 2} PR)
                            </div>
                            <button
                              onClick={() => setCuerpoMod(cuerpoMod + 1)}
                              className="px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-bold"
                            >
                              +
                            </button>
                          </div>
                        </div>

                        <div>
                          <label className="block text-slate-300 mb-2 font-semibold">
                            Destreza (Base: +{ndStats[nd].atributos})
                          </label>
                          <div className="flex items-center gap-2">
                            <button
                              onClick={() => setDestrezaMod(Math.max(destrezaMod - 1, -ndStats[nd].atributos - 3))}
                              className="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold"
                            >
                              âˆ’
                            </button>
                            <div className="flex-1 text-center bg-slate-700 py-2 rounded text-white font-bold">
                              {destrezaMod >= 0 ? '+' : ''}{destrezaMod} ({destrezaMod * 2} PR)
                            </div>
                            <button
                              onClick={() => setDestrezaMod(destrezaMod + 1)}
                              className="px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-bold"
                            >
                              +
                            </button>
                          </div>
                        </div>

                        <div>
                          <label className="block text-slate-300 mb-2 font-semibold">
                            Aura (Base: +{ndStats[nd].atributos})
                          </label>
                          <div className="flex items-center gap-2">
                            <button
                              onClick={() => setAuraMod(Math.max(auraMod - 1, -ndStats[nd].atributos - 3))}
                              className="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold"
                            >
                              âˆ’
                            </button>
                            <div className="flex-1 text-center bg-slate-700 py-2 rounded text-white font-bold">
                              {auraMod >= 0 ? '+' : ''}{auraMod} ({auraMod * 2} PR)
                            </div>
                            <button
                              onClick={() => setAuraMod(auraMod + 1)}
                              className="px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-bold"
                            >
                              +
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div className="bg-slate-800 rounded-lg shadow-xl p-6 border-2 border-yellow-600">
                      <h2 className="text-2xl font-bold text-yellow-400 mb-4">Equipo</h2>
                      
                      <div className="space-y-2 mb-4">
                        <div className="border border-slate-700 rounded-lg overflow-hidden">
                          <button
                            onClick={() => setOpenEquipmentCategory(openEquipmentCategory === 'weapons' ? null : 'weapons')}
                            className="w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-left font-semibold text-white flex justify-between items-center transition-colors"
                          >
                            <span>Armas</span>
                            <span className="text-xl">{openEquipmentCategory === 'weapons' ? 'âˆ’' : '+'}</span>
                          </button>
                          
                          {openEquipmentCategory === 'weapons' && (
                            <div className="p-3 bg-slate-750 space-y-2 max-h-60 overflow-y-auto">
                              {Object.entries(weapons).map(([catName, catWeapons]) => (
                                <div key={catName}>
                                  <div className="text-yellow-300 font-semibold text-sm mb-1">{catName}</div>
                                  {catWeapons.map((weapon, idx) => (
                                    <button
                                      key={idx}
                                      onClick={() => addEquipment(weapon, 'weapon')}
                                      className="w-full text-left p-2 bg-slate-700 hover:bg-yellow-900 rounded border border-yellow-600 transition-colors text-sm mb-1"
                                    >
                                      <div className="font-semibold text-yellow-200">{weapon.name}</div>
                                      <div className="text-slate-400 text-xs">{weapon.damage} {weapon.type}</div>
                                    </button>
                                  ))}
                                </div>
                              ))}
                            </div>
                          )}
                        </div>

                        <div className="border border-slate-700 rounded-lg overflow-hidden">
                          <button
                            onClick={() => setOpenEquipmentCategory(openEquipmentCategory === 'armor' ? null : 'armor')}
                            className="w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-left font-semibold text-white flex justify-between items-center transition-colors"
                          >
                            <span>Armaduras</span>
                            <span className="text-xl">{openEquipmentCategory === 'armor' ? 'âˆ’' : '+'}</span>
                          </button>
                          
                          {openEquipmentCategory === 'armor' && (
                            <div className="p-3 bg-slate-750 space-y-2 max-h-60 overflow-y-auto">
                              {armors.map((armor, idx) => (
                                <button
                                  key={idx}
                                  onClick={() => {
                                    setEquipment(equipment.filter(e => e.type !== 'armor'));
                                    if (armor.bonus > 0) addEquipment(armor, 'armor');
                                  }}
                                  className="w-full text-left p-2 bg-slate-700 hover:bg-yellow-900 rounded border border-yellow-600 transition-colors text-sm"
                                >
                                  <div className="font-semibold text-yellow-200">{armor.name}</div>
                                  <div className="text-slate-400 text-xs">Bono: +{armor.bonus}</div>
                                </button>
                              ))}
                            </div>
                          )}
                        </div>

                        <div className="border border-slate-700 rounded-lg overflow-hidden">
                          <button
                            onClick={() => setOpenEquipmentCategory(openEquipmentCategory === 'shields' ? null : 'shields')}
                            className="w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-left font-semibold text-white flex justify-between items-center transition-colors"
                          >
                            <span>Escudos</span>
                            <span className="text-xl">{openEquipmentCategory === 'shields' ? 'âˆ’' : '+'}</span>
                          </button>
                          
                          {openEquipmentCategory === 'shields' && (
                            <div className="p-3 bg-slate-750 space-y-2 max-h-60 overflow-y-auto">
                              {shields.map((shield, idx) => (
                                <button
                                  key={idx}
                                  onClick={() => {
                                    setEquipment(equipment.filter(e => e.type !== 'shield'));
                                    if (shield.bonus > 0) addEquipment(shield, 'shield');
                                  }}
                                  className="w-full text-left p-2 bg-slate-700 hover:bg-yellow-900 rounded border border-yellow-600 transition-colors text-sm"
                                >
                                  <div className="font-semibold text-yellow-200">{shield.name}</div>
                                  <div className="text-slate-400 text-xs">Bono: +{shield.bonus}</div>
                                </button>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      <div className="space-y-2">
                        {equipment.map(item => (
                          <div key={item.id} className="p-2 bg-slate-700 rounded flex justify-between items-center">
                            <div>
                              <div className="font-semibold text-white text-sm">{item.name}</div>
                              <div className="text-xs text-slate-400">
                                {item.type === 'weapon' ? `${item.damage} ${item.type}` : `Bono: +${item.bonus}`}
                              </div>
                            </div>
                            <button
                              onClick={() => removeEquipment(item.id)}
                              className="text-red-400 hover:text-red-300 ml-2 text-xl"
                            >
                              Ã—
                            </button>
                          </div>
                        ))}
                      </div>
                    </div>

                    <div className="bg-slate-800 rounded-lg shadow-xl p-6 border-2 border-purple-600">
                      <h2 className="text-2xl font-bold text-purple-400 mb-4">Biblioteca de Rasgos</h2>
                      
                      <div className="space-y-2">
                        {Object.entries(traits).map(([catName, catTraits]) => (
                          <div key={catName} className="border border-slate-700 rounded-lg overflow-hidden">
                            <button
                              onClick={() => setOpenCategory(openCategory === catName ? null : catName)}
                              className="w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 text-left font-semibold text-white flex justify-between items-center transition-colors"
                            >
                              <span>{catName}</span>
                              <span className="text-xl">{openCategory === catName ? 'âˆ’' : '+'}</span>
                            </button>
                            
                            {openCategory === catName && (
                              <div className="p-3 bg-slate-750 space-y-2 max-h-80 overflow-y-auto">
                                {catTraits.map((trait, idx) => (
                                  <button
                                    key={idx}
                                    onClick={() => addTrait(trait)}
                                    className="w-full text-left p-3 bg-slate-700 hover:bg-purple-900 rounded border border-purple-600 transition-colors"
                                  >
                                    <div className="flex justify-between items-start">
                                      <div className="flex-1">
                                        <div className="font-semibold text-purple-200">{trait.name}</div>
                                        <div className="text-sm text-slate-400 mt-1">{trait.desc}</div>
                                      </div>
                                      <div className="ml-2 text-purple-300 font-bold">
                                        {trait.cost > 0 ? '+' : ''}{trait.cost}
                                      </div>
                                    </div>
                                  </button>
                                ))}
                              </div>
                            )}
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>

                  <div className="space-y-6">
                    <div className="bg-slate-800 rounded-lg shadow-xl p-6 border-2 border-blue-600 sticky top-4">
                      <h2 className="text-2xl font-bold text-blue-400 mb-4">EstadÃ­sticas</h2>
                      
                      <div className="space-y-3 mb-4">
                        <div className="p-3 bg-slate-700 rounded">
                          <div className="text-slate-400 text-sm">Resistencia</div>
                          <div className="text-2xl font-bold text-white">{stats.resistencia}</div>
                        </div>
                        
                        <div className="grid grid-cols-2 gap-3">
                          <div className="p-3 bg-slate-700 rounded">
                            <div className="text-slate-400 text-sm">Defensa</div>
                            <div className="text-xl font-bold text-white">{stats.defensa}</div>
                          </div>
                          <div className="p-3 bg-slate-700 rounded">
                            <div className="text-slate-400 text-sm">Iniciativa</div>
                            <div className="text-xl font-bold text-white">{stats.iniciativa >= 0 ? '+' : ''}{stats.iniciativa}</div>
                          </div>
                        </div>

                        <div className="p-3 bg-slate-700 rounded">
                          <div className="text-slate-400 text-sm">Movimiento</div>
                          <div className="text-xl font-bold text-white">{stats.movimiento}m</div>
                        </div>
                        
                        <div className="grid grid-cols-3 gap-2">
                          <div className="p-2 bg-slate-700 rounded">
                            <div className="text-slate-400 text-xs">Cuerpo</div>
                            <div className="text-lg font-bold text-white">{stats.cuerpo >= 0 ? '+' : ''}{stats.cuerpo}</div>
                          </div>
                          <div className="p-2 bg-slate-700 rounded">
                            <div className="text-slate-400 text-xs">Destreza</div>
                            <div className="text-lg font-bold text-white">{stats.destreza >= 0 ? '+' : ''}{stats.destreza}</div>
                          </div>
                          <div className="p-2 bg-slate-700 rounded">
                            <div className="text-slate-400 text-xs">Aura</div>
                            <div className="text-lg font-bold text-white">{stats.aura >= 0 ? '+' : ''}{stats.aura}</div>
                          </div>
                        </div>
                        
                        <div className="p-3 rounded" style={{backgroundColor: stats.prRemaining >= 0 ? '#1e4d2b' : '#4d1e1e'}}>
                          <div className="text-slate-300 text-sm">Puntos de Rasgo</div>
                          <div className="text-2xl font-bold text-white">
                            {stats.prUsed} / {stats.prBase}
                          </div>
                          <div className="text-sm mt-1" style={{color: stats.prRemaining >= 0 ? '#4ade80' : '#f87171'}}>
                            Restantes: {stats.prRemaining}
                          </div>
                        </div>
                      </div>

                      <div className="space-y-3 mb-4 max-h-64 overflow-y-auto">
                        {selectedTraits.map(trait => (
                          <div key={trait.id} className="p-3 bg-slate-700 rounded">
                            <div className="flex justify-between items-start mb-1">
                              <div className="font-semibold text-white text-sm">{trait.name}</div>
                              <button
                                onClick={() => removeTrait(trait.id)}
                                className="text-red-400 hover:text-red-300 ml-2 text-xl"
                              >
                                Ã—
                              </button>
                            </div>
                            <div className="text-xs text-slate-400">{trait.desc}</div>
                            <div className="text-xs mt-1" style={{color: trait.cost > 0 ? '#4ade80' : '#f87171'}}>
                              {trait.cost > 0 ? '+' : ''}{trait.cost} PR
                            </div>
                          </div>
                        ))}
                      </div>

                      <button
                        onClick={exportAsText}
                        disabled={!name}
                        className="w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white rounded font-semibold transition-colors"
                      >
                        ðŸ“„ Exportar como Markdown
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CreatureCreator />);
    </script>
</body>
</html>
